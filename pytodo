#!/usr/bin/env python3
import argparse

import sqlite3


def create_task():
    print("Create new task")

    new_note = input("Enter new note:")
    note_name = input("Choose title for this note:")

    con = sqlite3.connect("sqlite_new.db")

    cursor = con.cursor()

    cursor.execute("CREATE TABLE IF NOT EXISTS all_notes (name, note, current_id)")

    cursor.execute(
        "INSERT INTO all_notes (name, note, current_id) VALUES (?,?,?)",
        (note_name, new_note, cursor.lastrowid)
    )

    con.commit()
    cursor.close()
    con.close()

    print("You could watch your note by 'list'")


def delete_task():
    parser.add_argument('id')

    args = parser.parse_args()

    con = sqlite3.connect("sqlite_new.db")

    cursor = con.cursor()

    cursor.execute("DELETE FROM all_notes WHERE id = '?'", ('delete', id))


def list_tasks():
    print("All tasks")


def undefined_command():
    print('Undefined command "{}". Use pytodo --help to learn about available commands'.format(command))


if __name__ == "__main__":
    parser = argparse.ArgumentParser()

    parser.add_argument('command', help='Command to run. Available commands: new, list, delete')

    args = parser.parse_args()

    command = args.command

    commands = {
        'new': create_task,
        'delete': delete_task,
        'list': list_tasks
    }

    commands.get(command, undefined_command)()
